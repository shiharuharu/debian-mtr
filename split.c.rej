***************
*** 103,115 ****
        name = dns_lookup(addr);
        if(name != NULL) {
         /* May be we should test name's length */
-        sprintf(newLine, "%s %d %d %d %d %d %d", name,
                 net_loss(at),
                 net_returned(at), net_xmit(at),
                 net_best(at) /1000, net_avg(at)/1000,
                 net_worst(at)/1000);
        } else {
-        sprintf(newLine, "%s %d %d %d %d %d %d",
                 strlongip( addr ),
                 net_loss(at),
                 net_returned(at), net_xmit(at),
--- 103,115 ----
        name = dns_lookup(addr);
        if(name != NULL) {
         /* May be we should test name's length */
+        snprintf(newLine,sizeof(newLine), "%s %d %d %d %d %d %d", name,
                 net_loss(at),
                 net_returned(at), net_xmit(at),
                 net_best(at) /1000, net_avg(at)/1000,
                 net_worst(at)/1000);
        } else {
+        snprintf(newLine,sizeof(newLine), "%s %d %d %d %d %d %d",
                 strlongip( addr ),
                 net_loss(at),
                 net_returned(at), net_xmit(at),
